# 题目：如何用 css 或 js 实现多行文本溢出省略效果，考虑兼容性

https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/246

# 笔记

之所以需要去琢磨如何实现这个效果，是因为，官方只支持单行文本溢出时 ... 的省略效果：

`text-overflow: ellipsis`

使用该属性需要满足一些前提：

1. 块级元素
2. overflow: 计算值`非visible`;
3. 元素宽度：超出时，有一个确切的计算值
4. white-space: nowrap | pre;

至于多行文本的溢出省略效果，Webkit 系列的浏览器倒是自己提供了：

1. display: -webkit-box | -webkit-inline-box;
2. -webkit-box-orient: vertical | block-axis
3. overflow: 计算值`非visible`
4. -webkit-line-clamp: N; // 行数

但这种方式不兼容，因为只适用于 Webkit 内核的浏览器，如 Chrome，Safari，iOS Safari，Chrome for Android，UC Browser for Android，Samsung Internet

所以，实现需要这种效果，只能另开思路，自己利用 CSS 或 js 来实现了，但目前的方案大多都有各自的一些不足处，没有一种完美的方案。

所以，遇到这种需求，建议第一步还是尽量跟产品怼一怼，看能不能砍掉吧。

实在非得做，再选择适用自己场景的方案吧。

### JS 实现

```html
<style type="text/css">
    .ellipsis {
      position: relative;
      width: 200px;
      max-height: 3em;
      line-height: 1.5;
      overflow: hidden;
      outline: 1px solid #ff9900;
    }
    .ellipsis::before {
      content: '...';
      position: absolute;
      z-index: 1;
      bottom: 0;
      right: 0;
      width: 1.5em;
      padding-left: 3px;
      box-sizing: border-box;
      background-color: white;
    }
    .ellipsis::after {
      content: '';
      display: inline-block;
      position: absolute;
      z-index: 2;
      width: 100%;
      height: 100%;
      background-color: white;
    }
  </style>

<div class="ellipsis">这是一串很长的文字</div>
  <div class="ellipsis">这是一串很长的文字，现在开始哦。第二行文字在这</div>
  <div class="ellipsis">这是一串很长的文字，现在开始哦。第二行文字在这里开始了，从“里”字开始，就应该被...省略了。</div>
```

![](https://upload-images.jianshu.io/upload_images/2699594-5f6a200e13b4b334.png)  

原理其实就是用 ... 拼接在文字后面，然后再 ... 上面又盖上一个空白区域，当文字溢出时，空白区域被迫移出区域，... 就显示出来了。

至于多行，就需要用 height 和 max-height 来控制。



### CSS 实现

- [多行文本省略近完美方案](https://www.jianshu.com/p/07bcb00aa0ee)



### JS 和 CSS 两者混合